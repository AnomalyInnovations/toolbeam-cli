{"version":3,"sources":["../../src/options/login.js"],"names":["userActions","prompts","name","description","message","required","hidden","replace","store","dispatch","load","isLoggedIn","getState","console","log","cyan","getUserEmail","start","delimiter","email","password","spinner","login","stop","red"],"mappings":";;;;;;;;;;;;;;AAAA;;;;AACA;;;;AACA;;AACA;;AACA;;IAAYA,W;;;;;;AAEZ,IAAMC,UAAU,CACf;AACCC,OAAM,OADP;AAECC,cAAa,mBAFd;AAGCC,UAAS,yBAHV;AAICC,WAAU;AAJX,CADe,EAOf;AACCH,OAAM,UADP;AAECC,cAAa,sBAFd;AAGCC,UAAS,4BAHV;AAICE,SAAQ,IAJT;AAKCC,UAAS,GALV;AAMCF,WAAU;AANX,CAPe,CAAhB;;;uEAiBe,iBAAeG,KAAf;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAEdA,YAAMC,QAAN,CAAeT,YAAYU,IAAZ,EAAf;;AAFc,WAIVV,YAAYW,UAAZ,CAAuBH,MAAMI,QAAN,EAAvB,CAJU;AAAA;AAAA;AAAA;;AAKbC,cAAQC,GAAR,CAAY,gBAAMC,IAAN,6BAAoCf,YAAYgB,YAAZ,CAAyBR,MAAMI,QAAN,EAAzB,CAApC,SAAZ;AALa;;AAAA;;AASd,uBAAOK,KAAP;;AAEA,uBAAOb,OAAP,GAAiB,EAAjB;AACA,uBAAOc,SAAP,GAAmB,EAAnB;;AAZc;AAAA,aAckB,wBAAUjB,OAAV,CAdlB;;AAAA;AAAA;AAcPkB,WAdO,SAcPA,KAdO;AAcAC,cAdA,SAcAA,QAdA;AAgBRC,aAhBQ,GAgBE,kBAAY,yBAAZ,CAhBF;;AAiBdA,cAAQJ,KAAR;;AAjBc;AAAA;AAAA,aAoBPT,MAAMC,QAAN,CAAeT,YAAYsB,KAAZ,CAAkBH,KAAlB,EAAyBC,QAAzB,CAAf,CApBO;;AAAA;AAqBbC,cAAQE,IAAR;AArBa;AAAA;;AAAA;AAAA;AAAA;;AAwBbF,cAAQE,IAAR;AACAV,cAAQC,GAAR,CAAY,gBAAMU,GAAN,oBAA2B,YAAEpB,OAA7B,CAAZ;AAzBa;;AAAA;;AA6BdS,cAAQC,GAAR,CAAY,gBAAMC,IAAN,CAAW,gCAAX,CAAZ;;AA7Bc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,E","file":"login.js","sourcesContent":["import prompt from 'prompt';\nimport chalk from 'chalk';\nimport { Spinner } from 'clui';\nimport { getPrompt } from '../libs/prompt';\nimport * as userActions from '../actions/user-actions';\n\nconst prompts = [\n\t{\n\t\tname: 'email',\n\t\tdescription: 'Enter your email:',\n\t\tmessage: 'Please enter your email',\n\t\trequired: true\n\t},\n\t{\n\t\tname: 'password',\n\t\tdescription: 'Enter your password:',\n\t\tmessage: 'Please enter your password',\n\t\thidden: true,\n\t\treplace: '*',\n\t\trequired: true\n\t},\n];\n\nexport default async function(store) {\n\n\tstore.dispatch(userActions.load());\n\n\tif (userActions.isLoggedIn(store.getState())) {\n\t\tconsole.log(chalk.cyan(`You are logged in as '${userActions.getUserEmail(store.getState())}'.`));\n\t\treturn;\n\t}\n\n\tprompt.start();\n\n\tprompt.message = '';\n\tprompt.delimiter = '';\n\n\tconst {email, password} = await getPrompt(prompts);\n\n\tconst spinner = new Spinner('Logging in to Toolbeamâ€¦');\n\tspinner.start();\n\n\ttry {\n\t\tawait store.dispatch(userActions.login(email, password));\n\t\tspinner.stop();\n\t}\n\tcatch(e) {\n\t\tspinner.stop();\n\t\tconsole.log(chalk.red(`Login failed: ${e.message}`));\n\t\treturn;\n\t}\n\n\tconsole.log(chalk.cyan('You are logged in to Toolbeam.'));\n\n}\n"]}