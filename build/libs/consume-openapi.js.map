{"version":3,"sources":["../../src/libs/consume-openapi.js"],"names":["toolsFromOpenapi","specNameFromOpenapi","operations","getOperationObject","oapi","ep","paths","path","operation","getIdFromEndpoint","getEndpoints","map","endpointsToTool","endpoint","info","title","host","reduce","acc","forEach","includes","toLowerCase","push","getNameFromEndpoint","name","replace","split","pop","capitalize","opr","id","operationId","ret","spec_path","str","charAt","toUpperCase","slice"],"mappings":";;;;;;;;;;QAIgBA,gB,GAAAA,gB;QAQAC,mB,GAAAA,mB;;;;AAZhB,IAAMC,aAAiB,CAAC,KAAD,EAAQ,KAAR,EAAe,MAAf,EAAuB,QAAvB,EAAiC,SAAjC,EAA4C,MAA5C,EAAoD,OAApD,CAAvB;AACA,IAAMC,qBAAqB,SAArBA,kBAAqB,CAACC,IAAD,EAAOC,EAAP;AAAA,QAAcD,KAAKE,KAAL,CAAWD,GAAGE,IAAd,EAAoBF,GAAGG,SAAvB,CAAd;AAAA,CAA3B;AACA,IAAMC,oBAAqB,SAArBA,iBAAqB;AAAA,QAASJ,GAAGG,SAAZ,SAAyBH,GAAGE,IAA5B;AAAA,CAA3B;;AAEO,SAASP,gBAAT,CAA0BI,IAA1B,EAAgC;AACtC,QAAOM,aAAaN,IAAb,EACLO,GADK,CACD;AAAA,SAAYC,gBAChBC,QADgB,EAEhBV,mBAAmBC,IAAnB,EAAyBS,QAAzB,CAFgB,CAAZ;AAAA,EADC,CAAP;AAKA;;AAEM,SAASZ,mBAAT,CAA6BG,IAA7B,EAAmC;AACzC,QAAQA,KAAKU,IAAL,IAAaV,KAAKU,IAAL,CAAUC,KAAxB,GACJX,KAAKU,IAAL,CAAUC,KADN,GAEJX,KAAKY,IAFR;AAGA;;AAED,SAASN,YAAT,CAAsBN,IAAtB,EAA4B;AAC3B,QAAO,oBAAYA,KAAKE,KAAjB,EAAwBW,MAAxB,CAA+B,UAACC,GAAD,EAAMX,IAAN,EAAe;AACpD,sBAAYH,KAAKE,KAAL,CAAWC,IAAX,CAAZ,EACEY,OADF,CACU,qBAAa;AACpBjB,cAAWkB,QAAX,CAAoBZ,UAAUa,WAAV,EAApB,CAAD,IACIH,IAAII,IAAJ,CAAS,EAACf,MAAMA,IAAP,EAAaC,WAAWA,SAAxB,EAAT,CADJ;AAEA,GAJF;AAKA,SAAOU,GAAP;AACA,EAPM,EAOJ,EAPI,CAAP;AAQA;;AAED,SAASK,mBAAT,CAA6BlB,EAA7B,EAAiC;AAChC,KAAMmB,OAAOnB,GAAGE,IAAH,CAAQkB,OAAR,CAAgB,KAAhB,EAAuB,EAAvB,EAA2BC,KAA3B,CAAiC,GAAjC,EAAsCC,GAAtC,EAAb;AACA,QAAQH,QAAQ,EAAT,GACJI,WAAWvB,GAAGG,SAAd,CADI,GAEDoB,WAAWvB,GAAGG,SAAd,CAFC,SAE2BoB,WAAWJ,IAAX,CAFlC;AAGA;;AAED,SAASZ,eAAT,CAAyBC,QAAzB,EAAmCgB,GAAnC,EAAwC;AAAA,KACzBtB,IADyB,GACMM,QADN,CAC/BN,IAD+B;AAAA,KACRC,SADQ,GACMK,QADN,CACnBL,SADmB;;AAEvC,KAAMgB,OAAOK,IAAI,WAAJ,IACVA,IAAI,WAAJ,CADU,GAEVN,oBAAoBV,QAApB,CAFH;AAGA,KAAMiB,KAAKD,IAAIE,WAAJ,GACRF,IAAIE,WADI,GAERtB,kBAAkBI,QAAlB,CAFH;AAGA,KAAMmB,MAAM;AACXR,QAASA,IADE;AAEXM,MAAQA,EAFG;AAGXG,aAAY,CAAC1B,IAAD,EAAOC,SAAP;AAHD,EAAZ;;AAMA;AACA,KAAIqB,IAAI,YAAJ,CAAJ,EAAuB;AACtBG,MAAI,OAAJ,IAAeH,IAAI,YAAJ,CAAf;AACA;;AAED,QAAOG,GAAP;AACA;;AAED,SAASJ,UAAT,CAAoBM,GAApB,EAAyB;AACxBA,OAAMA,IAAIb,WAAJ,EAAN;AACA,aAAUa,IAAIC,MAAJ,CAAW,CAAX,EAAcC,WAAd,EAAV,GAAwCF,IAAIG,KAAJ,CAAU,CAAV,CAAxC;AACA","file":"consume-openapi.js","sourcesContent":["const operations\t\t\t\t\t= ['get', 'put', 'post', 'delete', 'options', 'head', 'patch'];\nconst getOperationObject\t= (oapi, ep) => oapi.paths[ep.path][ep.operation];\nconst getIdFromEndpoint \t= ep => `${ep.operation} ${ep.path}`;\n\nexport function toolsFromOpenapi(oapi) {\n\treturn getEndpoints(oapi)\n\t\t.map(endpoint => endpointsToTool(\n\t\t\tendpoint,\n\t\t\tgetOperationObject(oapi, endpoint),\n\t\t));\n}\n\nexport function specNameFromOpenapi(oapi) {\n\treturn (oapi.info && oapi.info.title)\n\t\t? oapi.info.title\n\t\t: oapi.host;\n}\n\nfunction getEndpoints(oapi) {\n\treturn Object.keys(oapi.paths).reduce((acc, path) => {\n\t\tObject.keys(oapi.paths[path])\n\t\t\t.forEach(operation => {\n\t\t\t\t(operations.includes(operation.toLowerCase()))\n\t\t\t\t\t&& acc.push({path: path, operation: operation});\n\t\t\t});\n\t\treturn acc;\n\t}, []);\n}\n\nfunction getNameFromEndpoint(ep) {\n\tconst name = ep.path.replace(/^\\//, '').split('/').pop();\n\treturn (name == '')\n\t\t? capitalize(ep.operation)\n\t\t: `${capitalize(ep.operation)} ${capitalize(name)}`;\n}\n\nfunction endpointsToTool(endpoint, opr) {\n\tconst { path: path, operation: operation } = endpoint;\n\tconst name = opr['x-tb-name']\n\t\t? opr['x-tb-name']\n\t\t: getNameFromEndpoint(endpoint);\n\tconst id = opr.operationId\n\t\t? opr.operationId\n\t\t: getIdFromEndpoint(endpoint);\n\tconst ret = {\n\t\tname\t\t\t: name,\n\t\tid\t\t\t\t: id,\n\t\tspec_path\t: [path, operation]\n\t};\n\n\t// pass in color if defined\n\tif (opr['x-tb-color']) {\n\t\tret['color'] = opr['x-tb-color'];\n\t}\n\n\treturn ret;\n}\n\nfunction capitalize(str) {\n\tstr = str.toLowerCase();\n\treturn `${str.charAt(0).toUpperCase()}${str.slice(1)}`;\n}\n"]}